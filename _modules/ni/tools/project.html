<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ni.tools.project &mdash; Neuroinformatics Toolbox 0.2 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="top" title="Neuroinformatics Toolbox 0.2 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../../../index.html">
          <span>Neuroinformatics Toolbox 0.2 documentation</span></a></h1>
        <h2 class="heading"><span>ni.tools.project</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for ni.tools.project</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: ni.tools.project</span>
<span class="sd">   :platform: Unix</span>
<span class="sd">   :synopsis: Manages Python Projects using the ni toolbox</span>

<span class="sd">.. moduleauthor:: Jacob Huth &lt;jahuth@uos.de&gt;</span>

<span class="sd">NI Project Management</span>

<span class="sd"> - All steps in a configuration / simulation process will be logged to some folder structure</span>
<span class="sd"> - after the simulation and even after changing the original code, the results should still be viewable / interpretable with a project viewer</span>
<span class="sd"> - batches of runs should be easy to batch interpret (characteristic plots etc.)</span>
<span class="sd"> - metadata should contain among others:</span>
<span class="sd">	date</span>
<span class="sd">	software versions</span>
<span class="sd">	configuration options</span>
<span class="sd">	manual comments</span>
<span class="sd"> - saving of plots/data should be done by the project manager</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">datetime</span><span class="o">,</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="kn">as</span> <span class="nn">ET</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">html_reporter</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">guppy</span> <span class="kn">import</span> <span class="n">hpy</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">hpy</span> <span class="o">=</span> <span class="bp">None</span>
<span class="kn">from</span> <span class="nn">ni.tools.alert</span> <span class="kn">import</span> <span class="n">alert</span>
<span class="kn">import</span> <span class="nn">ni.config</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">ni.tools.html_view</span> <span class="kn">import</span> <span class="n">View</span>
<span class="k">try</span><span class="p">:</span>
	<span class="kn">import</span> <span class="nn">IPython</span>
<span class="k">except</span><span class="p">:</span>
	<span class="n">IPython</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="atoi"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.atoi">[docs]</a><span class="k">def</span> <span class="nf">atoi</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; converts text containing numbers into ints / used by :func:`natural_keys`&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">else</span> <span class="n">text</span>
</div>
<div class="viewcode-block" id="natural_keys"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.natural_keys">[docs]</a><span class="k">def</span> <span class="nf">natural_keys</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    alist.sort(key=natural_keys) sorts in human order</span>
<span class="sd">    (See Toothy&#39;s implementation in the comments of http://nedbatchelder.com/blog/200712/human_sorting.html )</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">[</span> <span class="n">atoi</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;(\d+)&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span> <span class="p">]</span>
</div>
<div class="viewcode-block" id="natural_sorted"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.natural_sorted">[docs]</a><span class="k">def</span> <span class="nf">natural_sorted</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; sorts a sortable in human order (0 &lt; 20 &lt; 100) &quot;&quot;&quot;</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="n">ll</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">natural_keys</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ll</span>
</div>
<div class="viewcode-block" id="VariableContainer"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.VariableContainer">[docs]</a><span class="k">class</span> <span class="nc">VariableContainer</span><span class="p">:</span>
	<span class="k">pass</span>
</div>
<div class="viewcode-block" id="ListContainer"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.ListContainer">[docs]</a><span class="k">class</span> <span class="nc">ListContainer</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">[]</span>
<div class="viewcode-block" id="ListContainer.append"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.ListContainer.append">[docs]</a>	<span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg_type</span><span class="p">,</span><span class="n">priority</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">txt</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">msg_type</span><span class="p">,</span><span class="n">priority</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">txt</span><span class="p">),</span><span class="n">txt</span><span class="p">))</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>
	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
<div class="viewcode-block" id="ListContainer.clear"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.ListContainer.clear">[docs]</a>	<span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">[]</span></div>
	<span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="PickleContainer"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.PickleContainer">[docs]</a><span class="k">class</span> <span class="nc">PickleContainer</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">f</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">[]</span>
<div class="viewcode-block" id="PickleContainer.append"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.PickleContainer.append">[docs]</a>	<span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg_type</span><span class="p">,</span><span class="n">priority</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">txt</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">msg_type</span><span class="p">,</span><span class="n">priority</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">txt</span><span class="p">),</span><span class="n">txt</span><span class="p">))</span></div>
	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
<div class="viewcode-block" id="PickleContainer.clear"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.PickleContainer.clear">[docs]</a>	<span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">[]</span></div>
	<span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LogContainer"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.LogContainer">[docs]</a><span class="k">class</span> <span class="nc">LogContainer</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">f</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">f</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">[]</span>
<div class="viewcode-block" id="LogContainer.append"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.LogContainer.append">[docs]</a>	<span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg_type</span><span class="p">,</span><span class="n">priority</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">job</span><span class="p">,</span><span class="n">txt</span><span class="p">):</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="s">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">:</span>
			<span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;&gt;&gt; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; &lt;&lt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; [&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg_type</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">priority</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot;]</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span><span class="p">)</span></div>
	<span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
<div class="viewcode-block" id="LogContainer.clear"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.LogContainer.clear">[docs]</a>	<span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="p">[]</span></div>
	<span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Figure"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Figure">[docs]</a><span class="k">class</span> <span class="nc">Figure</span><span class="p">:</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Figure Context Manager</span>

<span class="sd">	Can be used with the **with** statement::</span>

<span class="sd">		import ni</span>
<span class="sd">		x = np.arange(0,10,0.1)</span>
<span class="sd">		with ni.figure(&quot;some_test.png&quot;):</span>
<span class="sd">		    plot(cos(x)) 	# plots to a first plot</span>
<span class="sd">		    with ni.figure(&quot;some_other_test.png&quot;):</span>
<span class="sd">		        plot(-1*np.array(x)) # plots to a second plot</span>
<span class="sd">		    plot(sin(x))	# plots to the first plot again</span>

<span class="sd">	Or if they are to be used in an interactive console::</span>

<span class="sd">		import ni</span>
<span class="sd">		x = np.arange(0,10,0.1)</span>
<span class="sd">		with ni.figure(&quot;some_test.png&quot;,close=False):</span>
<span class="sd">			plot(cos(x)) 	# plots to a first plot</span>
<span class="sd">				with ni.figure(&quot;some_other_test.png&quot;,close=False):</span>
<span class="sd">					plot(-1*np.array(x)) # plots to a second plot</span>
<span class="sd">			plot(sin(x))	# plots to the first plot again</span>

<span class="sd">	Both figures will be displayed, but the second one will remain available after the code. (But keep in mind that in the iPython pylab console, after every input, all figures will be closed)</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path</span><span class="p">,</span><span class="n">display</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">close</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="n">display</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_close</span> <span class="o">=</span> <span class="n">close</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fig_stack</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axis_stack</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="bp">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="bp">None</span>
	<span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fig_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">gcf</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">axis_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tb</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">display</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="c"># trying to use ipython display</span>
				<span class="n">IPython</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="c"># otherwise presume that we run with some other gui backend. If we don&#39;t, nothing will happen.</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">warn</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">:</span>
			<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="bp">None</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fig_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axis_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
			<span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
			<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
			<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<div class="viewcode-block" id="Figure.show"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Figure.show">[docs]</a>	<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">close</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c"># trying to use ipython display</span>
			<span class="n">IPython</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="c"># otherwise presume that we run with some other gui backend. If we don&#39;t, nothing will happen.</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">warn</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">close</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
<div class="viewcode-block" id="Figure.close"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Figure.close">[docs]</a>	<span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="figure"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.figure">[docs]</a><span class="k">def</span> <span class="nf">figure</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">display</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">close</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>


<span class="sd">	Can be used with the **with** statement::</span>

<span class="sd">		import ni</span>
<span class="sd">		x = np.arange(0,10,0.1)</span>
<span class="sd">		with ni.figure(&quot;some_test.png&quot;):</span>
<span class="sd">		    plot(cos(x)) 	# plots to a first plot</span>
<span class="sd">		    with ni.figure(&quot;some_other_test.png&quot;):</span>
<span class="sd">		        plot(-1*np.array(x)) # plots to a second plot</span>
<span class="sd">		    plot(sin(x))	# plots to the first plot again</span>


<span class="sd">	Or if they are to be used in an interactive console::</span>


<span class="sd">		import ni</span>
<span class="sd">		x = np.arange(0,10,0.1)</span>
<span class="sd">		with ni.figure(&quot;some_test.png&quot;,display=True):</span>
<span class="sd">		    plot(cos(x)) 	# plots to a first plot</span>
<span class="sd">		    with ni.figure(&quot;some_other_test.png&quot;,close=False):</span>
<span class="sd">		        plot(-1*np.array(x)) # plots to a second plot</span>
<span class="sd">		    plot(sin(x))	# plots to the first plot again</span>

<span class="sd">	Both of these figures will be displayed, but the second one will remain open and can be activated again.</span>


<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="n">Figure</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">,</span><span class="n">close</span><span class="o">=</span><span class="n">close</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Job"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job">[docs]</a><span class="k">class</span> <span class="nc">Job</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">job_number</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s">&#39;initializing...&#39;</span><span class="p">,</span> <span class="n">dependencies</span><span class="o">=</span><span class="p">[]):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">session</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_name</span> <span class="o">=</span> <span class="n">job_name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_number</span> <span class="o">=</span> <span class="n">job_number</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">status_path</span> <span class="o">=</span> <span class="n">path</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s">&quot;.txt&quot;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">status_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job_number</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;_&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="nb">file</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">=</span> <span class="n">dependencies</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">instancename</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">last_touched</span> <span class="o">=</span> <span class="s">&#39;never&#39;</span><span class="c">#time.asctime()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">current_activity</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
<div class="viewcode-block" id="Job.can_run"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job.can_run">[docs]</a>	<span class="k">def</span> <span class="nf">can_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">update_jobs</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">dep</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">job_status</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dep</span><span class="p">)]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s">&quot;done.&quot;</span><span class="p">:</span>
						<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dep</span><span class="p">)][</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
							<span class="k">return</span> <span class="bp">False</span>
		<span class="k">return</span> <span class="bp">True</span></div>
<div class="viewcode-block" id="Job.update"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job.update">[docs]</a>	<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="o">+</span><span class="s">&quot;.txt&quot;</span><span class="p">):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="o">+</span><span class="s">&quot;.txt&quot;</span><span class="p">,</span><span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
					<span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
					<span class="n">ff</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span>
			<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
			<span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span></div>
<div class="viewcode-block" id="Job.get_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job.get_status">[docs]</a>	<span class="k">def</span> <span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="o">+</span><span class="s">&quot;.txt&quot;</span><span class="p">):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="o">+</span><span class="s">&quot;.txt&quot;</span><span class="p">,</span><span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
					<span class="n">s</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
					<span class="n">ff</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span>
			<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span>
			<span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
			<span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span></div>
<div class="viewcode-block" id="Job.set_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job.set_status">[docs]</a>	<span class="k">def</span> <span class="nf">set_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">msg</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">instancename</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">last_touched</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>
<div class="viewcode-block" id="Job.set_activity"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job.set_activity">[docs]</a>	<span class="k">def</span> <span class="nf">set_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">msg</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">current_activity</span> <span class="o">=</span> <span class="n">msg</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">instancename</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">last_touched</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_name</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_activity</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>
<div class="viewcode-block" id="Job.save"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job.save">[docs]</a>	<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;project&quot;</span><span class="p">,</span><span class="s">&quot;session&quot;</span><span class="p">]:</span>
				<span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="o">+</span><span class="s">&quot;.txt&quot;</span><span class="p">,</span><span class="s">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">))</span></div>
<div class="viewcode-block" id="Job.run"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job.run">[docs]</a>	<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameters</span><span class="o">=</span><span class="p">[]):</span>
		<span class="n">source_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">source_file</span><span class="p">):</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;File not found!&quot;</span><span class="p">)</span>
		<span class="n">_Project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span>
		<span class="n">l</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
		<span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameters</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;ThisProject&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;_out&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;_job&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_number</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;_current_project&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;_current_session&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;_current_job&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;__file__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">path</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;job_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;__name__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;__main__&quot;</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;tmp_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">tmp_path</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_activity</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;log&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">log</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">err</span>
		<span class="n">l</span><span class="p">[</span><span class="s">&quot;dbg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">dbg</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">containers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LogContainer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s">&#39;_log.txt&#39;</span><span class="p">))</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s">&quot;.git/refs/heads/master&quot;</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;Last ni.toolbox Revision: &#39;</span> <span class="o">+</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;.git/refs/heads/master&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot; from: &quot;</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="s">&quot;.git/refs/heads/master&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; (or slightly later)&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;Executing file &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">+</span> <span class="s">&#39; (on &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">hostname</span><span class="o">+</span><span class="s">&#39;:&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">instancename</span><span class="o">+</span><span class="s">&#39;) md5:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span><span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s"> Last changed on: &#39;</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">source_file</span><span class="p">)</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s">&quot;running...&quot;</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c">#exec(compile(open(self.folder+self.main).read(), self.folder+self.main, &#39;exec&#39;),globals(),l)</span>
			<span class="nb">execfile</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">variables</span> <span class="o">=</span> <span class="n">VariableContainer</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">variables</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">variables</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">err</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Writing to logfile...&quot;</span><span class="p">)</span>
			<span class="n">alert</span><span class="p">(</span><span class="s">&quot;Error! See logfile.&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s">&quot;failed.&quot;</span><span class="p">)</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s">&#39;_error.txt&#39;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">:</span>
				<span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
				<span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
			<span class="k">raise</span>
		<span class="n">alert</span><span class="p">(</span><span class="s">&quot;Success.&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s">&quot;done.&quot;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Writing to logfile...&quot;</span><span class="p">)</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;log.txt&quot;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">:</span>
			<span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
		<span class="n">variables</span> <span class="o">=</span> <span class="n">VariableContainer</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">variables</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">variables</span><span class="c">#l</span>
		<span class="k">return</span> <span class="n">variables</span></div>
<div class="viewcode-block" id="Job.html_view"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Job.html_view">[docs]</a>	<span class="k">def</span> <span class="nf">html_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="p">()</span>
		<span class="n">view</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot; / &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_name</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; ni. toolbox job&quot;</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s">&quot;session&quot;</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">!=</span> <span class="s">&quot;project&quot;</span><span class="p">:</span>
				<span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;/Info/table/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">v</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;_results.html&quot;</span><span class="p">):</span>
			<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;/Results&quot;</span><span class="p">,</span><span class="s">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="o">+</span><span class="s">&quot;job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;_&quot;</span><span class="o">+</span><span class="s">&quot;_results.html&quot;</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&gt;results&lt;/a&gt;&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;results.html&quot;</span><span class="p">):</span>
			<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;/Results&quot;</span><span class="p">,</span><span class="s">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="o">+</span><span class="s">&quot;job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;_&quot;</span><span class="o">+</span><span class="s">&quot;results.html&quot;</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&gt;results&lt;/a&gt;&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;_log.txt&quot;</span><span class="p">):</span>
			<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;/Log&quot;</span><span class="p">,</span><span class="s">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="o">+</span><span class="s">&quot;job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;_&quot;</span><span class="o">+</span><span class="s">&quot;_log.txt&quot;</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&gt;log&lt;/a&gt;&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;_error.txt&quot;</span><span class="p">):</span>
			<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;/Error&quot;</span><span class="p">,</span><span class="s">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="o">+</span><span class="s">&quot;job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;_&quot;</span><span class="o">+</span><span class="s">&quot;_error.txt&quot;</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&gt;Error log&lt;/a&gt;&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;error.txt&quot;</span><span class="p">):</span>
			<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;/Error&quot;</span><span class="p">,</span><span class="s">&quot;&lt;a href=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="o">+</span><span class="s">&quot;job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;_error.txt&quot;</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&gt;Error log&lt;/a&gt;&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">view</span>
</div></div>
<div class="viewcode-block" id="Session"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session">[docs]</a><span class="k">class</span> <span class="nc">Session</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">parameter_string</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
		<span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="n">run</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;sessions/session&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">run</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/&quot;</span>
			<span class="k">while</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
				<span class="n">run</span> <span class="o">=</span> <span class="n">run</span> <span class="o">+</span> <span class="mi">1</span>
				<span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;sessions/session&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">run</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/&quot;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;sessions/&quot;</span><span class="o">+</span><span class="n">path</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;sessions/&quot;</span><span class="o">+</span><span class="n">path</span>
			<span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="n">path</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="n">path</span>
			<span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;/&quot;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_status</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_counter</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parameter_string</span> <span class="o">=</span> <span class="n">parameter_string</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;status.txt&quot;</span><span class="p">,</span><span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">find_jobs</span><span class="p">()</span>
<div class="viewcode-block" id="Session.set_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.set_status">[docs]</a>	<span class="k">def</span> <span class="nf">set_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">msg</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;status.txt&quot;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>
<div class="viewcode-block" id="Session.abandon"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.abandon">[docs]</a>	<span class="k">def</span> <span class="nf">abandon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s">&quot;abandoned.&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Session.get_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.get_status">[docs]</a>	<span class="k">def</span> <span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">natural_sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span></div>
<div class="viewcode-block" id="Session.find_jobs"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.find_jobs">[docs]</a>	<span class="k">def</span> <span class="nf">find_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_jobs</span><span class="p">()</span></div>
<div class="viewcode-block" id="Session.setup_jobs"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.setup_jobs">[docs]</a>	<span class="k">def</span> <span class="nf">setup_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">source_file</span><span class="p">,</span><span class="n">parameter_string</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
		<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;jobs/&quot;</span><span class="p">)</span>
		<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_code/&quot;</span><span class="p">)</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;parameters.txt&quot;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_string</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">source_file</span><span class="p">):</span>
			<span class="n">job_file</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">jobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_job_file</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span><span class="n">parameter_string</span><span class="p">)</span>
			<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;Not a job file&quot;</span><span class="p">:</span>
					<span class="n">job_file</span> <span class="o">=</span> <span class="bp">False</span>
					<span class="k">return</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">raise</span>
			<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">jobs</span><span class="p">),</span> <span class="s">&quot; Jobs calculated.&quot;</span>
			<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_code/job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">[</span><span class="s">&quot;nr&quot;</span><span class="p">])</span><span class="o">+</span><span class="s">&quot;.py&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">code_file</span><span class="p">:</span>
					<span class="n">code_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">job</span><span class="p">[</span><span class="s">&quot;code&quot;</span><span class="p">])</span>
				<span class="n">_o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_job</span><span class="p">(</span><span class="n">job_name</span> <span class="o">=</span> <span class="n">job</span><span class="p">[</span><span class="s">&quot;job&quot;</span><span class="p">],</span><span class="n">job_number</span> <span class="o">=</span> <span class="n">job</span><span class="p">[</span><span class="s">&quot;nr&quot;</span><span class="p">],</span> <span class="nb">file</span><span class="o">=</span><span class="s">&quot;job_code/job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">[</span><span class="s">&quot;nr&quot;</span><span class="p">])</span><span class="o">+</span><span class="s">&quot;.py&quot;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span> <span class="s">&#39;pending&#39;</span><span class="p">,</span> <span class="n">dependencies</span><span class="o">=</span> <span class="n">job</span><span class="p">[</span><span class="s">&quot;dependencies&quot;</span><span class="p">])</span></div>
<div class="viewcode-block" id="Session.update_job_files"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.update_job_files">[docs]</a>	<span class="k">def</span> <span class="nf">update_job_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">source_file</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">parameter_string</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">source_file</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="n">source_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="s">&quot;main.py&quot;</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">source_file</span><span class="p">):</span>
			<span class="n">job_file</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">jobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_job_file</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span><span class="n">parameter_string</span><span class="p">)</span>
			<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;Not a job file&quot;</span><span class="p">:</span>
					<span class="n">job_file</span> <span class="o">=</span> <span class="bp">False</span>
					<span class="k">return</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">raise</span>
			<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">jobs</span><span class="p">),</span> <span class="s">&quot; Jobs calculated.&quot;</span>
			<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_code/job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">[</span><span class="s">&quot;nr&quot;</span><span class="p">])</span><span class="o">+</span><span class="s">&quot;.py&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">code_file</span><span class="p">:</span>
					<span class="n">code_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">job</span><span class="p">[</span><span class="s">&quot;code&quot;</span><span class="p">])</span></div>
<div class="viewcode-block" id="Session.parse_job_file"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.parse_job_file">[docs]</a>	<span class="k">def</span> <span class="nf">parse_job_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">parameter_string</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">parameter_string</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="n">parameter_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter_string</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;parameters.txt&quot;</span><span class="p">,</span><span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
					<span class="n">parameter_string</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span>
		<span class="n">new_files</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">quantifiers</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">tagged_lines</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">preamble</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">ordered_jobs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">dependencies</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">source_file</span><span class="p">:</span>
			<span class="n">source</span> <span class="o">=</span> <span class="n">source_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
			<span class="n">job</span> <span class="o">=</span> <span class="s">&quot;#preamble&quot;</span>
			<span class="n">last_indent</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
			<span class="n">job_indent</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
			<span class="n">job_indent_stack</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">job_stack</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">indent_specified</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)):</span>
				<span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;## End of Parameters&quot;</span><span class="p">):</span>
					<span class="n">preamble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;## Changed Parameters: &quot;</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parameter_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">):</span>
						<span class="n">preamble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
				<span class="n">indent</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;^([\t ]*)&#39;</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;^[\t ]*(.*)&#39;</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">indent_specified</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">indent</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">job_indent</span><span class="p">):</span>
						<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Parsing Error for indent at line &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; in file: &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
					<span class="n">job_indent</span> <span class="o">=</span> <span class="n">indent</span>
					<span class="n">indent_specified</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">indent</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">job_indent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
					<span class="k">while</span> <span class="n">indent</span> <span class="o">!=</span> <span class="n">job_indent</span><span class="p">:</span>
						<span class="n">_job</span> <span class="o">=</span> <span class="n">job</span>
						<span class="n">job</span> <span class="o">=</span> <span class="n">job_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
						<span class="n">job_indent</span> <span class="o">=</span> <span class="n">job_indent_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;job &quot;</span><span class="p">):</span>
					<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;job *((\&quot;.*\&quot;)|(</span><span class="se">\&#39;</span><span class="s">.*</span><span class="se">\&#39;</span><span class="s">)|(\&quot;\&quot;\&quot;.*\&quot;\&quot;\&quot;))(.*:)&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">m</span><span class="p">:</span>
						<span class="n">name</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
						<span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&quot;\&quot;\&quot;</span><span class="s">&#39;</span><span class="p">):</span>
							<span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
						<span class="n">quantifier</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
						<span class="n">job_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
						<span class="n">job_indent_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job_indent</span><span class="p">)</span>
						<span class="n">job</span> <span class="o">=</span> <span class="n">name</span>
						<span class="n">indent_specified</span> <span class="o">=</span> <span class="bp">False</span>
						<span class="n">quantifiers</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r&#39;for (.*?) in (.*?)(?=(?= for)|:)&#39;</span><span class="p">,</span><span class="n">quantifier</span><span class="p">)</span>
						<span class="n">dependencies</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
						<span class="n">ordered_jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Parsing Error in job ... : declaration at line &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; in file: &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;require &quot;</span><span class="p">):</span>
					<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;require *((\&quot;.*\&quot;)|(</span><span class="se">\&#39;</span><span class="s">.*</span><span class="se">\&#39;</span><span class="s">)|(\&quot;\&quot;\&quot;.*\&quot;\&quot;\&quot;))&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
					<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ordered_jobs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
						<span class="n">r</span> <span class="o">=</span> <span class="n">ordered_jobs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">r</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
					<span class="k">if</span> <span class="n">m</span><span class="p">:</span>
						<span class="n">r</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
						<span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&quot;\&quot;\&quot;</span><span class="s">&#39;</span><span class="p">):</span>
							<span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
					<span class="n">dependencies</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">real_indent</span> <span class="o">=</span> <span class="n">indent</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">job_indent</span><span class="p">):]</span>
					<span class="n">real_line</span> <span class="o">=</span> <span class="n">real_indent</span> <span class="o">+</span> <span class="n">line</span>
					<span class="n">new_files</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="n">real_line</span>
					<span class="k">if</span> <span class="n">job</span> <span class="o">==</span> <span class="s">&quot;#preamble&quot;</span><span class="p">:</span>
						<span class="n">preamble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">real_line</span><span class="p">)</span>
					<span class="n">tagged_lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">job</span><span class="p">,</span><span class="n">real_line</span><span class="p">))</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ordered_jobs</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Not a job file&quot;</span><span class="p">)</span>
		<span class="n">preamble_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">preamble</span><span class="p">),{</span><span class="s">&#39;parameters&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">})</span>
		<span class="n">unique_jobs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_files</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="n">independent_jobs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ordered_jobs</span><span class="p">:</span>
			<span class="n">independent</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">for</span> <span class="n">j_2</span> <span class="ow">in</span> <span class="n">ordered_jobs</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">j</span> <span class="o">==</span> <span class="n">j_2</span> <span class="ow">and</span> <span class="n">j_2</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
					<span class="n">independent</span> <span class="o">=</span> <span class="bp">False</span>
			<span class="k">if</span> <span class="n">independent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">independent_jobs</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">independent_jobs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
					<span class="k">pass</span> <span class="c">#dependencies[j] = [independent_jobs[-1]]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">pass</span> <span class="c">#dependencies[j] = []</span>
				<span class="n">independent_jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
		<span class="n">jobs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">j_nr</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">i_j</span> <span class="ow">in</span> <span class="n">independent_jobs</span><span class="p">:</span>
			<span class="k">print</span> <span class="s">&quot;---------------------------------------&quot;</span>
			<span class="n">quantified_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;&quot;</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">i_j</span> <span class="ow">in</span> <span class="n">quantifiers</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quantifiers</span><span class="p">[</span><span class="n">i_j</span><span class="p">]:</span>
					<span class="n">new_quantified_parameters</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="k">for</span> <span class="n">qp</span> <span class="ow">in</span> <span class="n">quantified_parameters</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">qi</span> <span class="ow">in</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">preamble_vars</span><span class="p">):</span>
							<span class="n">new_quantified_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qp</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">qi</span><span class="p">)</span><span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
					<span class="n">quantified_parameters</span> <span class="o">=</span> <span class="n">new_quantified_parameters</span>
			<span class="k">for</span> <span class="n">qp</span> <span class="ow">in</span> <span class="n">quantified_parameters</span><span class="p">:</span>
				<span class="n">code</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">qp</span>
				<span class="k">for</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span><span class="n">line</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tagged_lines</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">i_j</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
						<span class="n">code</span> <span class="o">=</span> <span class="n">code</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
				<span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;nr&#39;</span><span class="p">:</span><span class="n">j_nr</span><span class="p">,</span><span class="s">&#39;job&#39;</span><span class="p">:</span><span class="n">i_j</span><span class="p">,</span><span class="s">&#39;quantified_parameters&#39;</span><span class="p">:</span> <span class="n">quantified_parameters</span><span class="p">,</span><span class="s">&#39;code&#39;</span><span class="p">:</span><span class="n">code</span><span class="p">,</span><span class="s">&#39;dependencies&#39;</span><span class="p">:</span><span class="n">dependencies</span><span class="p">[</span><span class="n">i_j</span><span class="p">]})</span>
				<span class="n">j_nr</span> <span class="o">=</span> <span class="n">j_nr</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="k">return</span> <span class="n">jobs</span></div>
<div class="viewcode-block" id="Session.execute"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.execute">[docs]</a>	<span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">code</span><span class="p">,</span><span class="n">local_vars</span> <span class="o">=</span> <span class="p">{}):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="s">&quot;parameters&quot;</span> <span class="ow">in</span> <span class="n">local_vars</span><span class="p">:</span>
			<span class="n">local_vars</span><span class="p">[</span><span class="s">&quot;parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">local_vars</span><span class="p">[</span><span class="s">&quot;_current_project&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span>
		<span class="n">local_vars</span><span class="p">[</span><span class="s">&quot;_current_session&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="n">local_vars</span><span class="p">[</span><span class="s">&quot;_current_job&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TemporaryJob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="s">&quot;Preamble&quot;</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">exec</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">local_vars</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span>
		<span class="k">return</span> <span class="n">local_vars</span></div>
<div class="viewcode-block" id="Session.update_jobs"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.update_jobs">[docs]</a>	<span class="k">def</span> <span class="nf">update_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c">#self.jobs = {}</span>
		<span class="n">job_status</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_status/&quot;</span><span class="p">):</span>
				<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_status/&quot;</span><span class="p">):</span>
					<span class="n">res</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&quot;job_(.*)\.txt&quot;</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">res</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
						<span class="n">job</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
						<span class="k">if</span> <span class="n">job</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="n">Job</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_status/job_&quot;</span><span class="o">+</span><span class="n">job</span><span class="p">)</span>
						<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span> <span class="ow">in</span> <span class="n">job_status</span><span class="p">:</span>
							<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="n">job_status</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">]:</span>
								<span class="n">job_status</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_status</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
							<span class="k">else</span><span class="p">:</span>
								<span class="n">job_status</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">job_status</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">status</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_status</span> <span class="o">=</span> <span class="n">job_status</span></div>
<div class="viewcode-block" id="Session.next_job"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.next_job">[docs]</a>	<span class="k">def</span> <span class="nf">next_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retry_failed</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">ignore_dependencies</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">natural_sorted</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">):</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s">&quot;pending&quot;</span><span class="p">:</span>
				<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">retry_failed</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s">&quot;failed.&quot;</span><span class="p">:</span>
				<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
		<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;End of Jobs&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Session.add_job"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.add_job">[docs]</a>	<span class="k">def</span> <span class="nf">add_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">job_number</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_status/&quot;</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_status/&quot;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">job_number</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="k">while</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_counter</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">job_counter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_counter</span> <span class="o">+</span> <span class="mi">1</span>
			<span class="n">job_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_counter</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">Job</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;job_status/job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job_number</span><span class="p">),</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">job_number</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
		<span class="c">#if type(dic) == dict:</span>
		<span class="c">#	self.jobs[job_number].__dict__.update(dic)</span>
		<span class="c">#self.jobs[job_number].save()</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job_number</span><span class="p">]</span></div>
<div class="viewcode-block" id="Session.print_job_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.print_job_status">[docs]</a>	<span class="k">def</span> <span class="nf">print_job_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_jobs</span><span class="p">()</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
		<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">job</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span>
			<span class="k">if</span> <span class="s">&quot;done.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;done.&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; done &quot;</span>
			<span class="k">if</span> <span class="s">&quot;starting...&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;starting...&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; starting &quot;</span>
			<span class="k">if</span> <span class="s">&quot;running...&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;running...&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; running &quot;</span>
			<span class="k">if</span> <span class="s">&quot;pending&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;pending&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; pending &quot;</span>
			<span class="k">if</span> <span class="s">&quot;failed.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;failed.&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; failed &quot;</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
		<span class="k">return</span> <span class="n">s</span></div>
<div class="viewcode-block" id="Session.print_long_job_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.print_long_job_status">[docs]</a>	<span class="k">def</span> <span class="nf">print_long_job_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_jobs</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">job</span> <span class="o">+</span> <span class="s">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
		<span class="k">return</span> <span class="n">s</span></div>
<div class="viewcode-block" id="Session.reset_failed_jobs"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.reset_failed_jobs">[docs]</a>	<span class="k">def</span> <span class="nf">reset_failed_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">which</span><span class="o">=</span><span class="s">&quot;failed.&quot;</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="s">&quot;pending&quot;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_jobs</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">which</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">to</span><span class="p">)</span></div>
<div class="viewcode-block" id="Session.save_html"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.save_html">[docs]</a>	<span class="k">def</span> <span class="nf">save_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s">&quot;session.html&quot;</span><span class="p">):</span>
		<span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">html_view</span><span class="p">()</span>
		<span class="n">view</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="n">path</span><span class="p">)</span></div>
<div class="viewcode-block" id="Session.html_view"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Session.html_view">[docs]</a>	<span class="k">def</span> <span class="nf">html_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">view</span> <span class="o">=</span> <span class="n">View</span><span class="p">()</span>
		<span class="n">view</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot; / &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot; ni. toolbox session&quot;</span>
		<span class="c">#view.add(&quot;#0/Project&quot;,self.project)</span>
		<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="s">&quot;pending&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#1/Job Status/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/table/pending&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;pending&quot;</span><span class="p">]))</span>
			<span class="k">if</span> <span class="s">&quot;starting...&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#1/Job Status/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/table/starting&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;starting...&quot;</span><span class="p">]))</span>
			<span class="k">if</span> <span class="s">&quot;done.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#1/Job Status/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/table/done&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;done.&quot;</span><span class="p">]))</span>
			<span class="k">if</span> <span class="s">&quot;running...&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#1/Job Status/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/table/running&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;running...&quot;</span><span class="p">]))</span>
			<span class="k">if</span> <span class="s">&quot;failed.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#1/Job Status/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/table/failed&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;failed.&quot;</span><span class="p">]))</span>
		<span class="n">jobs</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jobs</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#2/Jobs/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s">&quot;starting...&quot;</span><span class="p">:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#2/Jobs/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/.style&quot;</span><span class="p">,</span><span class="s">&quot;background-color: lightyellow; color: yellow;&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s">&quot;running...&quot;</span><span class="p">:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#2/Jobs/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/.style&quot;</span><span class="p">,</span><span class="s">&quot;background-color: lightyellow; color: black;&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s">&quot;failed.&quot;</span><span class="p">:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#2/Jobs/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/.style&quot;</span><span class="p">,</span><span class="s">&quot;color: darkred;&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s">&quot;done.&quot;</span><span class="p">:</span>
				<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;#2/Jobs/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">job_name</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/tabs/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/.style&quot;</span><span class="p">,</span><span class="s">&quot;color: darkgreen;&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">view</span>
</div></div>
<div class="viewcode-block" id="TemporaryJob"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.TemporaryJob">[docs]</a><span class="k">class</span> <span class="nc">TemporaryJob</span><span class="p">(</span><span class="n">Job</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">project</span><span class="p">,</span><span class="n">session</span><span class="p">,</span><span class="n">job_name</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">session</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_name</span> <span class="o">=</span> <span class="n">job_name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">status_path</span> <span class="o">=</span> <span class="s">&quot;temp_job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s">&quot;.txt&quot;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">status_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_path</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;temp_job_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;_&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s">&quot;ghosting&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="nb">file</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dependencies</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">instancename</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">last_touched</span> <span class="o">=</span> <span class="s">&#39;never&#39;</span><span class="c">#time.asctime()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">job_number</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>

</div>
<div class="viewcode-block" id="TemporarySession"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.TemporarySession">[docs]</a><span class="k">class</span> <span class="nc">TemporarySession</span><span class="p">(</span><span class="n">Session</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">project</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_status</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_counter</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="s">&quot;temp_session&quot;</span>
</div>
<div class="viewcode-block" id="Project"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project">[docs]</a><span class="k">class</span> <span class="nc">Project</span><span class="p">:</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Project Class</span>

<span class="sd">	loads a Project folder (containing eg. a main.py file)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span> <span class="o">=</span> <span class="s">&quot;unsaved_project&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&quot;/&quot;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span>
		<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">folder</span> <span class="o">==</span> <span class="s">&quot;unsaved_project&quot;</span><span class="p">:</span>
				<span class="n">name</span> <span class="o">=</span> <span class="s">&quot;New Project&quot;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_mode</span> <span class="o">=</span> <span class="s">&quot;no jobs&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">logging</span> <span class="o">=</span> <span class="bp">True</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">code_files</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">ListContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="n">ListContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dbgs</span> <span class="o">=</span> <span class="n">ListContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">msgs</span> <span class="o">=</span> <span class="n">ListContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">containers</span> <span class="o">=</span> <span class="p">[</span><span class="n">ListContainer</span><span class="p">()]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">current_job</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_status</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">retry_failed</span> <span class="o">=</span> <span class="bp">True</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">log_updated_on_priority</span> <span class="o">=</span> <span class="mi">1</span> <span class="c"># a msg with a greater or equal priority will cause a logifle update</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="s">&quot;main.py&quot;</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">main</span> <span class="o">=</span> <span class="s">&quot;main.py&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="s">&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP%2BgvaeTAAAACXBI%0AWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QoYCTQZbfmiOAAAABl0RVh0Q29tbWVudABDcmVhdGVk%0AIHdpdGggR0lNUFeBDhcAAAM/SURBVGje7VhbSBRhFP4m11ugm8iiiD2lIoUPvghC5g3qRbHoRRPx%0AFkj4VLG55hJWQij00hKuRMgi2VYPjqGIZiBroBCY6EKLpmup6Y66eYnNnXX370Ecmd2ZEXdNXJoP%0Ahplz/nMO/zcz5zJD0TRNEMRQAEBRUVFQbr67uxunEOSQCfyXBIYtw0ivT0d0VTRaP7QGH4ESXQnG%0Af4xjy7kF7Ttt8BGIU8Zx18pIZeBl9NjL391uNNFNmLHNoOFqQ/ARSIxNhL5aL1chySfgcDpg27DB%0AyljRO96Lrs9dsK5aQV7tTh62dRvaPrah50sPZplZOFgHkuKSkH8hH9prWsRGxfLieTwe2H/bsbS%2B%0ABMtPCwYmB9A/0Y95%2BzwX80gJpN9Px9TylI%2BeEAJdvw7at1pEhEUg73weMs5lYGR6BGPfxzC5MAnj%0AqBETTyagUqo4v77xPhQ8LTj6R0DTNBGCx%2BMhzDpDKvWVBDfAHcXPiomqRkXah9oJ62I5%2B52dHVKi%0AK%2BHsqvRVPjE3HZvE9NVEMh9k8mL6C5qmiWgOUBQFlVKFxuuNPP2CfQHmZjMqsisQqgjl9CEhIdAU%0AajjZZDH5xIyKjEJWahbaqtv%2BfQ7sIeFMAk8erB9EeFi4oG1yfDJ3PcPMiMZMiU85vlFCoeBzFNs8%0AAESGR%2B7nCsQTUyqGPMzJBGQCMoGTBZfLDZZ1%2B0/AyTp5MutiRW2911w7roBi0p3TSIsxIC3GgPfG%0Ab/4R8G5IcytzorazzKykvAfzgpknW1esgnYPb49g%2B48bzm03Ht0ZPTyB5V/LUHeqeTqNUYO1rTUf%0A29XNVdS/qefp1J1qMBsMJ7vdboxZx1DzsoZnV/e6Dov2Rd/GeHq/iYaFC2%2BVommaCP3Yyn2ciyHL%0AkLATKJRdLIPhlgEAUN5ajo5PHaLdNyc1B7WXa1H6vBSsW/wVbClugbpw/4aZBuZx7%2BbuTNX84hKy%0Ar5z1%2BbElOo0GAySnUbmMygQOSYCiKNEPGynsrXufhXyFbA6CWAz5FZIJyARkAieMACHCc4yY3nvd%0A%2ByzkK2RzEMRiHNgHAqn//tR1KX%2Bpvck5IBOQCcgETmgfCKT%2B%2B1PXpfyl9qbgPo6DFH8BkBmOWDZo%0AfhoAAAAASUVORK5CYII%3D%0A&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">instancename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;description.txt&quot;</span><span class="p">):</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;description.txt&quot;</span><span class="p">,</span><span class="s">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">containers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LogContainer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="s">&#39;log.txt&#39;</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">find_sessions</span><span class="p">()</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">path</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">update_job_status</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">print_job_status</span><span class="p">()</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">print</span> <span class="s">&quot;Errors occured:&quot;</span>
			<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">:</span>
				<span class="k">print</span> <span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">e</span>
<div class="viewcode-block" id="Project.find_sessions"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.find_sessions">[docs]</a>	<span class="k">def</span> <span class="nf">find_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;sessions/&quot;</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">sess</span> <span class="ow">in</span> <span class="n">natural_sorted</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;sessions/&quot;</span><span class="p">)):</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sess</span><span class="p">))</span>
				<span class="k">except</span><span class="p">:</span>
					<span class="k">raise</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span></div>
<div class="viewcode-block" id="Project.select_session"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.select_session">[docs]</a>	<span class="k">def</span> <span class="nf">select_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">s</span>
			<span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">s</span></div>
<div class="viewcode-block" id="Project.last_run"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.last_run">[docs]</a>	<span class="k">def</span> <span class="nf">last_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;run/&quot;</span><span class="p">):</span>
			<span class="n">last_run</span> <span class="o">=</span> <span class="bp">False</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">natural_sorted</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;run/&quot;</span><span class="p">)):</span>
				<span class="n">res</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&quot;run(\d*)&quot;</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">res</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
					<span class="n">last_run</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">return</span> <span class="n">last_run</span>
		<span class="k">return</span> <span class="bp">False</span></div>
<div class="viewcode-block" id="Project.get_parameters_from_job_file"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.get_parameters_from_job_file">[docs]</a>	<span class="k">def</span> <span class="nf">get_parameters_from_job_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">parameters</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">param_flag</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;main.py&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">source_file</span><span class="p">:</span>
			<span class="n">source</span> <span class="o">=</span> <span class="n">source_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)):</span>
				<span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;## Parameters&quot;</span><span class="p">):</span>
					<span class="n">param_flag</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="k">if</span> <span class="n">param_flag</span><span class="p">:</span>
					<span class="n">parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">])</span>
				<span class="k">if</span> <span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;## End of Parameters&quot;</span><span class="p">):</span>
					<span class="n">param_flag</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="k">return</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.setup_jobs"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.setup_jobs">[docs]</a>	<span class="k">def</span> <span class="nf">setup_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameter_string</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameter_string</span><span class="o">=</span><span class="n">parameter_string</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">setup_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;main.py&quot;</span><span class="p">,</span><span class="n">parameter_string</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_job_status</span><span class="p">()</span></div>
<div class="viewcode-block" id="Project.update_job_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.update_job_status">[docs]</a>	<span class="k">def</span> <span class="nf">update_job_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">!=</span> <span class="bp">False</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">update_jobs</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">job_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">job_status</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">jobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">jobs</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
				<span class="n">ff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">ff</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span><span class="p">[</span><span class="n">ff</span><span class="o">.</span><span class="n">status</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span><span class="p">[</span><span class="n">ff</span><span class="o">.</span><span class="n">status</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span><span class="p">[</span><span class="n">ff</span><span class="o">.</span><span class="n">status</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span></div>
<div class="viewcode-block" id="Project.less_running_than"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.less_running_than">[docs]</a>	<span class="k">def</span> <span class="nf">less_running_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
		<span class="n">running</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">if</span> <span class="s">&quot;running...&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span><span class="p">:</span>
			<span class="n">running</span> <span class="o">=</span> <span class="n">running</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span><span class="p">[</span><span class="s">&quot;running...&quot;</span><span class="p">]</span>
		<span class="k">if</span> <span class="s">&quot;starting...&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span><span class="p">:</span>
			<span class="n">running</span> <span class="o">=</span> <span class="n">running</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">overall_status</span><span class="p">[</span><span class="s">&quot;starting...&quot;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">running</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">True</span>
		<span class="k">return</span> <span class="bp">False</span></div>
<div class="viewcode-block" id="Project.print_job_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.print_job_status">[docs]</a>	<span class="k">def</span> <span class="nf">print_job_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_job_status</span><span class="p">()</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
		<span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">job</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span>
			<span class="k">if</span> <span class="s">&quot;done.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;done.&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; done &quot;</span>
			<span class="k">if</span> <span class="s">&quot;starting...&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;starting...&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; starting &quot;</span>
			<span class="k">if</span> <span class="s">&quot;running...&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;running...&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; running &quot;</span>
			<span class="k">if</span> <span class="s">&quot;pending&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;pending&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; pending &quot;</span>
			<span class="k">if</span> <span class="s">&quot;failed.&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">]:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="n">job</span><span class="p">][</span><span class="s">&quot;failed.&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; failed &quot;</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
		<span class="k">return</span> <span class="n">s</span></div>
<div class="viewcode-block" id="Project.print_long_job_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.print_long_job_status">[docs]</a>	<span class="k">def</span> <span class="nf">print_long_job_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">print_long_job_status</span><span class="p">()</span></div>
<div class="viewcode-block" id="Project.reset_failed_jobs"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.reset_failed_jobs">[docs]</a>	<span class="k">def</span> <span class="nf">reset_failed_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">reset_failed_jobs</span><span class="p">()</span></div>
<div class="viewcode-block" id="Project.abandon"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.abandon">[docs]</a>	<span class="k">def</span> <span class="nf">abandon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s">&quot;abandoned.&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.set_session_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.set_session_status">[docs]</a>	<span class="k">def</span> <span class="nf">set_session_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s">&quot;running...&quot;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.get_session_status"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.get_session_status">[docs]</a>	<span class="k">def</span> <span class="nf">get_session_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">status</span></div>
<div class="viewcode-block" id="Project.job_activate"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.job_activate">[docs]</a>	<span class="k">def</span> <span class="nf">job_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s">&quot;running...&quot;</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.job_done"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.job_done">[docs]</a>	<span class="k">def</span> <span class="nf">job_done</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">job_activate</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="s">&quot;done.&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.next_job"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.next_job">[docs]</a>	<span class="k">def</span> <span class="nf">next_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_dependencies</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_job_status</span><span class="p">()</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">next_job</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">retry_failed</span><span class="p">,</span> <span class="n">ignore_dependencies</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.require_job"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.require_job">[docs]</a>	<span class="k">def</span> <span class="nf">require_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
		<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">update_job_status</span><span class="p">()</span>
			<span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">:</span>
				<span class="n">all_done</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s">&quot;done.&quot;</span><span class="p">:</span>
						<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_status</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)][</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
							<span class="n">all_done</span> <span class="o">=</span> <span class="bp">False</span>
				<span class="k">if</span> <span class="n">all_done</span><span class="p">:</span>
					<span class="k">break</span>
			<span class="k">print</span> <span class="s">&quot;Required Job not done.&quot;</span>
			<span class="k">print</span> <span class="s">&quot;</span><span class="se">\n\n\n</span><span class="s">Waiting to retry...&quot;</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">True</span></div>
<div class="viewcode-block" id="Project.do_log"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.do_log">[docs]</a>	<span class="k">def</span> <span class="nf">do_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">logging</span> <span class="o">=</span> <span class="n">b</span></div>
<div class="viewcode-block" id="Project.msg"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.msg">[docs]</a>	<span class="k">def</span> <span class="nf">msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg_type</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logging</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
				<span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg_type</span><span class="p">,</span><span class="n">priority</span><span class="p">,</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">,</span><span class="n">txt</span><span class="p">)</span>
			<span class="c">#if priority &gt;= self.log_updated_on_priority:</span>
			<span class="c">#	self.msgs.append((msg_type,priority,datetime.datetime.now(),self.current_job,str(txt),txt))</span>
			<span class="c">##if priority &gt;= self.log_updated_on_priority:</span>
			<span class="c">#with open(self.path+&quot;log.txt&quot;,&quot;a&quot;) as logfile:</span>
			<span class="c">#	logfile.write(&quot;&gt;&gt; &quot; + str(self.current_job) + &quot; &lt;&lt;\n&quot; + str(datetime.datetime.now()) + &quot; [&quot; + str(msg_type) +&quot;/&quot; + str(priority) +&quot;]\n&quot; + str(txt) + &quot;\n\n&quot;)</span></div>
<div class="viewcode-block" id="Project.log"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.log">[docs]</a>	<span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logging</span><span class="p">:</span>
			<span class="c">#self.logs.append(str(txt))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">priority</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">print</span> <span class="n">txt</span></div>
<div class="viewcode-block" id="Project.dbg"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.dbg">[docs]</a>	<span class="k">def</span> <span class="nf">dbg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logging</span><span class="p">:</span>
			<span class="c">#self.dbgs.append(str(txt))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s">&#39;Debug&#39;</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">priority</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">print</span> <span class="s">&quot;Dbg: &quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.err"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.err">[docs]</a>	<span class="k">def</span> <span class="nf">err</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">logging</span><span class="p">:</span>
			<span class="c">#self.errors.append(str(txt))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="p">(</span><span class="s">&#39;Error&#39;</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">priority</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">print</span> <span class="s">&quot;Error: &quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.clear"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.clear">[docs]</a>	<span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">ListContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="n">ListContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dbgs</span> <span class="o">=</span> <span class="n">ListContainer</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">msgs</span> <span class="o">=</span> <span class="n">ListContainer</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
			<span class="n">c</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="p">{}</span></div>
<div class="viewcode-block" id="Project.report"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.report">[docs]</a>	<span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">silent</span> <span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="c">#self.reportHTML()</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s">&quot;          ---- Report ----</span><span class="se">\n\n</span><span class="s">&quot;</span>
		<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">list</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;&gt;&gt; &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; &lt;&lt;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; [&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span><span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span><span class="s">&quot;]</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n\n</span><span class="s">&quot;</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
					<span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s">&quot; [&quot;</span><span class="p">,</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s">&quot;] &quot;</span><span class="p">,</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">          ----        ----</span><span class="se">\n</span><span class="s">&quot;</span>
		<span class="k">return</span> <span class="n">s</span></div>
<div class="viewcode-block" id="Project.reportHTML"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.reportHTML">[docs]</a>	<span class="k">def</span> <span class="nf">reportHTML</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">rep</span> <span class="o">=</span> <span class="n">html_reporter</span><span class="o">.</span><span class="n">Reporter</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
			<span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">rep</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="p">{</span><span class="s">&#39;date&#39;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s">&#39;priority&#39;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;msg&#39;</span><span class="p">:</span> <span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">]})</span>
		<span class="n">rep</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;report.html&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.job"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.job">[docs]</a>	<span class="k">def</span> <span class="nf">job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		TODO: rename to something else</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">current_job</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.subjob"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.subjob">[docs]</a>	<span class="k">def</span> <span class="nf">subjob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
		<span class="n">jj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">current_job</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.sibjob"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.sibjob">[docs]</a>	<span class="k">def</span> <span class="nf">sibjob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Sibling Job</span>

<span class="sd">		Is on the same level as the previous job (ie. a child of its parent)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="s">&quot;/&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">:</span>
			<span class="n">jj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">current_job</span> <span class="o">=</span> <span class="n">jj</span>
		<span class="n">jj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">current_job</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.superjob"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.superjob">[docs]</a>	<span class="k">def</span> <span class="nf">superjob</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="s">&quot;/&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">:</span>
			<span class="n">jj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">current_job</span> <span class="o">=</span> <span class="n">jj</span></div>
<div class="viewcode-block" id="Project.save"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.save">[docs]</a>	<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Saving to &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;.p&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;.p&quot;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span>
		<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
<div class="viewcode-block" id="Project.dumpheap"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.dumpheap">[docs]</a>	<span class="k">def</span> <span class="nf">dumpheap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">hpy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
			<span class="n">h</span> <span class="o">=</span> <span class="n">hpy</span><span class="p">()</span>
			<span class="n">h</span><span class="o">.</span><span class="n">heap</span><span class="p">()</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;_heap_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span><span class="s">&quot;_&quot;</span><span class="p">))</span><span class="o">+</span><span class="s">&quot;.txt&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">)</span>
			<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;_heap_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_job</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span><span class="s">&quot;_&quot;</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;_str.txt&quot;</span><span class="p">,</span><span class="s">&quot;w+&quot;</span><span class="p">)</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">heap</span><span class="p">()))</span>
			<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
<div class="viewcode-block" id="Project.next"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.next">[docs]</a>	<span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s">&quot;next&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.autorun"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.autorun">[docs]</a>	<span class="k">def</span> <span class="nf">autorun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;abandoned.&quot;</span><span class="p">:</span>
					<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;This session is abandoned.&quot;</span><span class="p">)</span>
				<span class="n">next_job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">next_job</span><span class="p">()</span>
				<span class="n">next_job</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s">&quot;starting...&quot;</span><span class="p">)</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="k">print</span> <span class="s">&quot;Job &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">next_job</span><span class="o">.</span><span class="n">job_number</span><span class="p">),</span> <span class="s">&quot;:&quot;</span>
					<span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="n">next_job</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">require_job</span><span class="p">(</span><span class="n">dep</span><span class="p">)</span>
				<span class="k">except</span><span class="p">:</span>
					<span class="n">next_job</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="s">&quot;pending&quot;</span><span class="p">)</span>
				<span class="n">next_job</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
			<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;End of Jobs&quot;</span><span class="p">:</span>
					<span class="k">print</span> <span class="s">&quot;End of Jobs&quot;</span>
					<span class="k">pass</span>
					<span class="k">break</span>
				<span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;This session is abandoned.&quot;</span><span class="p">:</span>
					<span class="k">print</span> <span class="s">&quot;This session is abandoned.&quot;</span>
					<span class="k">pass</span>
					<span class="k">break</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">print</span> <span class="s">&quot;Error occured:&quot;</span>
					<span class="k">print</span> <span class="n">e</span>
					<span class="k">raise</span></div>
<div class="viewcode-block" id="Project.run"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.run">[docs]</a>	<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameters</span><span class="o">=</span><span class="p">[],</span><span class="n">job</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
			<span class="n">run</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;run/run&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">run</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/&quot;</span>
			<span class="k">while</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
				<span class="n">run</span> <span class="o">=</span> <span class="n">run</span> <span class="o">+</span> <span class="mi">1</span>
				<span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;run/run&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">run</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;/&quot;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
			<span class="n">source_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span>
			<span class="n">_Project</span> <span class="o">=</span> <span class="bp">self</span>
			<span class="n">l</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">job</span> <span class="o">==</span> <span class="s">&quot;next&quot;</span><span class="p">:</span>
				<span class="n">_job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_job</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">_job</span> <span class="o">=</span> <span class="n">job</span>
			<span class="k">print</span> <span class="n">source_file</span>
			<span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parameters</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;ThisProject&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;_out&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;_job&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_job</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;_current_project&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;__file__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;job_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="n">_job</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;__name__&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;__main__&quot;</span>
			<span class="n">l</span><span class="p">[</span><span class="s">&quot;tmp_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">tmp_path</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">containers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LogContainer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="n">_job</span> <span class="o">+</span> <span class="s">&#39;_log.txt&#39;</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s">&quot;.git/refs/heads/master&quot;</span><span class="p">):</span>
						<span class="n">log</span><span class="p">(</span><span class="s">&#39;Last ni.toolbox Revision: &#39;</span> <span class="o">+</span><span class="nb">open</span><span class="p">(</span><span class="s">&quot;.git/refs/heads/master&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot; from: &quot;</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="s">&quot;.git/refs/heads/master&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; (or slightly later)&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;Executing file &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span> <span class="o">+</span> <span class="s">&#39; (on &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">hostname</span><span class="o">+</span><span class="s">&#39;:&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">instancename</span><span class="o">+</span><span class="s">&#39;) md5:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">())</span><span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s"> Last changed on: &#39;</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">)</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
			<span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;Copied to: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">job_activate</span><span class="p">(</span><span class="n">_job</span><span class="p">)</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="c">#exec(compile(open(self.folder+self.main).read(), self.folder+self.main, &#39;exec&#39;),globals(),l)</span>
				<span class="nb">execfile</span><span class="p">(</span><span class="n">source_file</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="c">#e = sys.exc_info()</span>
				<span class="n">variables</span> <span class="o">=</span> <span class="n">VariableContainer</span><span class="p">()</span>
				<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="n">variables</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">variables</span> <span class="c">#l</span>
				<span class="c">#self.save(&#39;variables&#39;,l)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">err</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Writing to logfile...&quot;</span><span class="p">)</span>
				<span class="n">alert</span><span class="p">(</span><span class="s">&quot;Error! See logfile.&quot;</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">job_activate</span><span class="p">(</span><span class="n">_job</span><span class="p">,</span><span class="s">&quot;failed.&quot;</span><span class="p">)</span>
				<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="n">_job</span> <span class="o">+</span> <span class="s">&#39;_error.txt&#39;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">:</span>
					<span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
					<span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
				<span class="k">raise</span>
			<span class="n">alert</span><span class="p">(</span><span class="s">&quot;Success.&quot;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">job_done</span><span class="p">(</span><span class="n">_job</span><span class="p">)</span>
			<span class="c">#self.save(&#39;variables&#39;,l)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;Writing to logfile...&quot;</span><span class="p">)</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="o">+</span><span class="s">&quot;log.txt&quot;</span><span class="p">,</span><span class="s">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">:</span>
				<span class="n">logfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
			<span class="n">variables</span> <span class="o">=</span> <span class="n">VariableContainer</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">l</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">variables</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">o</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">variables</span><span class="c">#l</span>
			<span class="k">return</span> <span class="n">variables</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">jobs</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">jobs</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">run</span><span class="p">()</span></div>
<div class="viewcode-block" id="Project.save_html"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.save_html">[docs]</a>	<span class="k">def</span> <span class="nf">save_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s">&quot;project.html&quot;</span><span class="p">):</span>
		<span class="n">view</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">html_view</span><span class="p">()</span>
		<span class="n">view</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="n">path</span><span class="p">)</span></div>
<div class="viewcode-block" id="Project.html_view"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.html_view">[docs]</a>	<span class="k">def</span> <span class="nf">html_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">view</span> <span class="o">=</span> <span class="n">ni</span><span class="o">.</span><span class="n">View</span><span class="p">()</span>
		<span class="n">view</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot; ni. toolbox project&quot;</span>
		<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;/hidden/folder&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">)</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s">&quot;&lt;h1&gt;&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;&lt;/h1&gt;&quot;</span>
		<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;description&#39;</span><span class="p">):</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span>
		<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;logo&#39;</span><span class="p">):</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;&lt;div style=</span><span class="se">\&quot;</span><span class="s">float: right;</span><span class="se">\&quot;</span><span class="s">&gt;&lt;img src=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">logo</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">&gt;&lt;/div&gt;&quot;</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;&lt;h2&gt;Sessions:&lt;/h2&gt;&lt;ul&gt;&quot;</span>
		<span class="k">for</span> <span class="n">sess</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">)):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">sess</span><span class="p">]</span><span class="o">.</span><span class="n">save_html</span><span class="p">(</span><span class="s">&quot;session.html&quot;</span><span class="p">)</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;&lt;li&gt;&lt;a href=</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">sess</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="p">):]</span><span class="o">+</span><span class="s">&quot;session.html</span><span class="se">\&quot;</span><span class="s">&gt;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">sess</span><span class="p">]</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span><span class="o">+</span><span class="s">&quot;sessions/&quot;</span><span class="p">):])</span><span class="o">+</span><span class="s">&quot;&lt;/a&gt;&lt;/li&gt;&quot;</span>
		<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;&lt;/ul&gt;&quot;</span>
		<span class="n">view</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">view</span></div>
<div class="viewcode-block" id="Project.execute"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.execute">[docs]</a>	<span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">code</span><span class="p">,</span><span class="n">local_vars</span> <span class="o">=</span> <span class="p">{},</span><span class="n">session</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="s">&quot;parameters&quot;</span> <span class="ow">in</span> <span class="n">local_vars</span><span class="p">:</span>
			<span class="n">local_vars</span><span class="p">[</span><span class="s">&quot;parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">session</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
				<span class="n">session</span> <span class="o">=</span> <span class="n">TemporarySession</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&quot;Setup&quot;</span><span class="p">)</span>
			<span class="n">local_vars</span><span class="p">[</span><span class="s">&quot;_current_project&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
			<span class="n">local_vars</span><span class="p">[</span><span class="s">&quot;_current_session&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">session</span>
			<span class="n">local_vars</span><span class="p">[</span><span class="s">&quot;_current_job&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TemporaryJob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">session</span><span class="p">,</span><span class="s">&quot;Preamble&quot;</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">exec</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">local_vars</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">raise</span>
		<span class="k">return</span> <span class="n">local_vars</span></div>
<div class="viewcode-block" id="Project.parse_job_file"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.Project.parse_job_file">[docs]</a>	<span class="k">def</span> <span class="nf">parse_job_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">session</span><span class="p">):</span>
		<span class="n">new_files</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">quantifiers</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">tagged_lines</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">preamble</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">ordered_jobs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">dependencies</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">source_file</span><span class="p">:</span>
			<span class="n">source</span> <span class="o">=</span> <span class="n">source_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
			<span class="n">job</span> <span class="o">=</span> <span class="s">&quot;#preamble&quot;</span>
			<span class="n">last_indent</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
			<span class="n">job_indent</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
			<span class="n">job_indent_stack</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">job_stack</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">indent_specified</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)):</span>
				<span class="n">indent</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;^([\t ]*)&#39;</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;^[\t ]*(.*)&#39;</span><span class="p">,</span><span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">indent_specified</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">indent</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">job_indent</span><span class="p">):</span>
						<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Parsing Error for indent at line &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; in file: &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
					<span class="n">job_indent</span> <span class="o">=</span> <span class="n">indent</span>
					<span class="n">indent_specified</span> <span class="o">=</span> <span class="bp">True</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">indent</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">job_indent</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">source</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
					<span class="k">while</span> <span class="n">indent</span> <span class="o">!=</span> <span class="n">job_indent</span><span class="p">:</span>
						<span class="n">_job</span> <span class="o">=</span> <span class="n">job</span>
						<span class="n">job</span> <span class="o">=</span> <span class="n">job_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
						<span class="n">job_indent</span> <span class="o">=</span> <span class="n">job_indent_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;job &quot;</span><span class="p">):</span>
					<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;job *((\&quot;.*\&quot;)|(</span><span class="se">\&#39;</span><span class="s">.*</span><span class="se">\&#39;</span><span class="s">)|(\&quot;\&quot;\&quot;.*\&quot;\&quot;\&quot;))(.*:)&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">m</span><span class="p">:</span>
						<span class="n">name</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
						<span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&quot;\&quot;\&quot;</span><span class="s">&#39;</span><span class="p">):</span>
							<span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
						<span class="n">quantifier</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
						<span class="n">job_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
						<span class="n">job_indent_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job_indent</span><span class="p">)</span>
						<span class="n">job</span> <span class="o">=</span> <span class="n">name</span>
						<span class="n">indent_specified</span> <span class="o">=</span> <span class="bp">False</span>
						<span class="n">quantifiers</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r&#39;for (.*?) in (.*?)(?=(?= for)|:)&#39;</span><span class="p">,</span><span class="n">quantifier</span><span class="p">)</span>
						<span class="n">dependencies</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
						<span class="n">ordered_jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Parsing Error in job ... : declaration at line &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; in file: &quot;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;require &quot;</span><span class="p">):</span>
					<span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">r&#39;require *((\&quot;.*\&quot;)|(</span><span class="se">\&#39;</span><span class="s">.*</span><span class="se">\&#39;</span><span class="s">)|(\&quot;\&quot;\&quot;.*\&quot;\&quot;\&quot;))&#39;</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
					<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ordered_jobs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
						<span class="n">r</span> <span class="o">=</span> <span class="n">ordered_jobs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">r</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
					<span class="k">if</span> <span class="n">m</span><span class="p">:</span>
						<span class="n">r</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
						<span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\&quot;\&quot;\&quot;</span><span class="s">&#39;</span><span class="p">):</span>
							<span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
					<span class="n">dependencies</span><span class="p">[</span><span class="n">job</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">real_indent</span> <span class="o">=</span> <span class="n">indent</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">job_indent</span><span class="p">):]</span>
					<span class="n">real_line</span> <span class="o">=</span> <span class="n">real_indent</span> <span class="o">+</span> <span class="n">line</span>
					<span class="n">new_files</span><span class="p">[</span><span class="n">job</span><span class="p">]</span> <span class="o">=</span> <span class="n">real_line</span>
					<span class="k">if</span> <span class="n">job</span> <span class="o">==</span> <span class="s">&quot;#preamble&quot;</span><span class="p">:</span>
						<span class="n">preamble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">real_line</span><span class="p">)</span>
					<span class="n">tagged_lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">job</span><span class="p">,</span><span class="n">real_line</span><span class="p">))</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ordered_jobs</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Not a job file&quot;</span><span class="p">)</span>
		<span class="n">preamble_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">preamble</span><span class="p">),</span><span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
		<span class="n">unique_jobs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_files</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
		<span class="n">independent_jobs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ordered_jobs</span><span class="p">:</span>
			<span class="n">independent</span> <span class="o">=</span> <span class="bp">True</span>
			<span class="k">for</span> <span class="n">j_2</span> <span class="ow">in</span> <span class="n">ordered_jobs</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">j</span> <span class="o">==</span> <span class="n">j_2</span> <span class="ow">and</span> <span class="n">j_2</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
					<span class="n">independent</span> <span class="o">=</span> <span class="bp">False</span>
			<span class="k">if</span> <span class="n">independent</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">independent_jobs</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">independent_jobs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
					<span class="k">pass</span> <span class="c">#dependencies[j] = [independent_jobs[-1]]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">pass</span> <span class="c">#dependencies[j] = []</span>
				<span class="n">independent_jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
		<span class="n">jobs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">j_nr</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">i_j</span> <span class="ow">in</span> <span class="n">independent_jobs</span><span class="p">:</span>
			<span class="k">print</span> <span class="s">&quot;---------------------------------------&quot;</span>
			<span class="n">quantified_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;&quot;</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">i_j</span> <span class="ow">in</span> <span class="n">quantifiers</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quantifiers</span><span class="p">[</span><span class="n">i_j</span><span class="p">]:</span>
					<span class="n">new_quantified_parameters</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="c">#print &quot;--&gt; &quot;,q[0],&quot; = &quot;,q[1],&quot;[i]&quot;</span>
					<span class="c">#print q[1], &quot; = &quot;, eval(q[1],preamble_vars)</span>
					<span class="k">for</span> <span class="n">qp</span> <span class="ow">in</span> <span class="n">quantified_parameters</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">qi</span> <span class="ow">in</span> <span class="nb">eval</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">preamble_vars</span><span class="p">):</span>
							<span class="n">new_quantified_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qp</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">qi</span><span class="p">)</span><span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
					<span class="n">quantified_parameters</span> <span class="o">=</span> <span class="n">new_quantified_parameters</span>
			<span class="k">for</span> <span class="n">qp</span> <span class="ow">in</span> <span class="n">quantified_parameters</span><span class="p">:</span>
				<span class="n">code</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">preamble</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="n">qp</span>
				<span class="k">for</span> <span class="p">(</span><span class="n">tag</span><span class="p">,</span><span class="n">line</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tagged_lines</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">i_j</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
						<span class="n">code</span> <span class="o">=</span> <span class="n">code</span> <span class="o">+</span> <span class="n">line</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
				<span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s">&#39;nr&#39;</span><span class="p">:</span><span class="n">j_nr</span><span class="p">,</span><span class="s">&#39;job&#39;</span><span class="p">:</span><span class="n">i_j</span><span class="p">,</span><span class="s">&#39;quantified_parameters&#39;</span><span class="p">:</span> <span class="n">quantified_parameters</span><span class="p">,</span><span class="s">&#39;code&#39;</span><span class="p">:</span><span class="n">code</span><span class="p">,</span><span class="s">&#39;dependencies&#39;</span><span class="p">:</span><span class="n">dependencies</span><span class="p">[</span><span class="n">i_j</span><span class="p">]})</span>
				<span class="n">j_nr</span> <span class="o">=</span> <span class="n">j_nr</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="k">return</span> <span class="n">jobs</span>
</div></div>
<span class="k">try</span><span class="p">:</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">name</span>
<span class="k">except</span><span class="p">:</span>
	<span class="n">_current_project</span> <span class="o">=</span> <span class="n">Project</span><span class="p">()</span>

<div class="viewcode-block" id="load"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.load">[docs]</a><span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
	<span class="k">global</span> <span class="n">_current_project</span>
	<span class="n">_current_project</span> <span class="o">=</span> <span class="n">Project</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">_current_project</span></div>
<div class="viewcode-block" id="log"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.log">[docs]</a><span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span><span class="p">)</span></div>
<div class="viewcode-block" id="dbg"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.dbg">[docs]</a><span class="k">def</span> <span class="nf">dbg</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">dbg</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span><span class="p">)</span></div>
<div class="viewcode-block" id="err"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.err">[docs]</a><span class="k">def</span> <span class="nf">err</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">err</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="n">priority</span><span class="p">)</span></div>
<div class="viewcode-block" id="report"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.report">[docs]</a><span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">_current_project</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">silent</span><span class="p">)</span></div>
<div class="viewcode-block" id="run"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.run">[docs]</a><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="save"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.save">[docs]</a><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="job"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.job">[docs]</a><span class="k">def</span> <span class="nf">job</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">job</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="subjob"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.subjob">[docs]</a><span class="k">def</span> <span class="nf">subjob</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">subjob</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="sibjob"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.sibjob">[docs]</a><span class="k">def</span> <span class="nf">sibjob</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">sibjob</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="superjob"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.superjob">[docs]</a><span class="k">def</span> <span class="nf">superjob</span><span class="p">():</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">superjob</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="dumpheap"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.dumpheap">[docs]</a><span class="k">def</span> <span class="nf">dumpheap</span><span class="p">():</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">dumpheap</span><span class="p">()</span></div>
<div class="viewcode-block" id="do_log"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.do_log">[docs]</a><span class="k">def</span> <span class="nf">do_log</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
	<span class="n">_current_project</span><span class="o">.</span><span class="n">do_log</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="require_job"><a class="viewcode-back" href="../../../ni.tools.html#ni.tools.project.require_job">[docs]</a><span class="k">def</span> <span class="nf">require_job</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">_current_project</span><span class="o">.</span><span class="n">require_job</span><span class="p">(</span><span class="n">j</span><span class="p">)</span></div>
</pre></div>

      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2013, Jacob Huth.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>